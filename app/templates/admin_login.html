<!--
    VULNERABILITY: No CSRF Protection
    Concept: The login form does not contain a CSRF token. While the primary impact of CSRF is on state-changing
             actions, a login form can still be a target for Login CSRF. An attacker could log an unsuspecting
             user into an account they control. If the application stores sensitive information in the session or
             associates user activity with the session, the attacker could capture this information when the user
             interacts with the application while logged into the attacker's account.
    Enumeration: An attacker would create a malicious page that auto-submits a POST request to this login endpoint
                 with credentials for an account they control. When a victim visits the malicious page, they are
                 unknowingly logged into the attacker's account.
    Fix: Add a unique, unpredictable CSRF token to the form and validate it on the server side upon submission.
         This ensures that the login request originates from the application's own form.

    VULNERABILITY: Weak Password Policy & Brute-force Vulnerability
    Concept: The login form does not enforce any password complexity requirements, and there is no mechanism to
             prevent or slow down brute-force attacks (e.g., account lockout after several failed attempts, rate
             limiting, CAPTCHA). This makes admin accounts susceptible to being compromised through password guessing
             or automated dictionary attacks.
    Enumeration: Use a tool like Burp Suite Intruder or Hydra to launch a dictionary attack against the /admin/login
                 endpoint with a common password list. The server will likely respond with a 200 OK for successful
                 logins and a different status or response for failed ones, allowing the tool to identify valid
                 credentials.
    Fix: Implement account lockout policies, rate limiting on login attempts per IP and per account, and a CAPTCHA
         after a certain number of failed attempts. Enforce a strong password policy for all admin accounts.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { background-color: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { text-align: center; color: #333; }
        .form-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; color: #555; }
        input[type="email"], input[type="password"] { width: 100%; padding: 0.75rem; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 0.75rem; background-color: #dc3545; color: white; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; }
        button:hover { background-color: #b52a37; }
        .footer-text { text-align: center; margin-top: 1rem; }
        .error { color: red; text-align: center; margin-bottom: 1rem; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Admin Login</h2>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <p class="error">{{ messages[0] }}</p>
            {% endif %}
        {% endwith %}
        <!-- FIX: The form now includes a CSRF token via form.hidden_tag() -->
        <form method="post" action="/admin/login">
            {{ form.hidden_tag() }}
            <div class="form-group">
                <label for="email">Email</label>
                {{ form.email(required=True) }}
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                {{ form.password(required=True) }}
            </div>
            <button type="submit">Login as Admin</button>
        </form>
        <div class="footer-text">
            <p>Not registered? <a href="/admin/register">Register here</a></p>
        </div>
    </div>
</body>
</html>